<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>관리 메뉴</title>

    <script src="/common/js/include.js"></script>
    <script src="/common/js/common.js"></script>
</head>

<body>
    <!-- 헤더 -->
    <header class="mainHead">
        <div class="hidden"></div>
        <h3 class="logoSec">
            LOGO
        </h3>
        <i class="fa-solid fa-bars"></i>
    </header>
    <!-- 헤더 -->

    <!-- 컨텐츠 영역 -->
    <div class="conBox main">
        <div id="calendar-container">
            <div id="calendar-header">
                <span id="current-month"></span>
                <div>
                    <button id="prev-month"><i class="fa-solid fa-angle-left"></i></button>
                    <button id="next-month"><i class="fa-solid fa-angle-right"></i></button>
                </div>
            </div>
            <div id="calendar"></div>
            <button id="toggle-view"><i class="fa-solid fa-angle-down"></i></button>
        </div>

        <div class="userSec">
            <div class="top">
                <div class="user">
                    <div class="profile">
                        <span class="unset">
                            ABC 사업부
                        </span>
                    </div>
                </div>
            </div>
        </div>

        <div class="mainList">
            <div class="total">
                <div class="workTotal">
                    <h5>출근</h5>
                    <span>00
                        <p>명</p>
                    </span>
                </div>
                <div class="line"></div>
                <div class="noneTotal">
                    <h5>미출근</h5>
                    <span>00
                        <p>명</p>
                    </span>
                </div>
            </div>
            <div class="gauge">
                <span class="gauge-text">00/00 (00%)</span>
                <div class="gauge-content">
                    <div class="progress-bar" role="progressbar" style="width: 60%;" aria-valuenow="60" aria-valuemin="0" aria-valuemax="100"></div>
                </div>
            </div>

            <div class="mainWorkerList personalWorkerList">
                <div class="mainUserSec">
                    <div class="top">
                        <div class="user">
                            <div class="proImg"></div>
                            <div class="profile">
                                <span>
                                    황보현진
                                    <p>[직책명]</p>
                                </span>
                                <bl>abc1234567<bl>
                            </div>
                        </div>
                        <div class="time">
                            <span>출근 <p>-</p></span>
                            <span>퇴근 <p>-</p></span>
                        </div>
                    </div>
                    <div class="mainState gtw">출근</div>
                </div>
            </div>

            <div class="mainWorkerList">
                <div class="mainUserSec">
                    <div class="top">
                        <div class="user">
                            <div class="proImg"></div>
                            <div class="profile">
                                <span>
                                    황보현진
                                    <p>[직책명]</p>
                                </span>
                                <bl>abc1234567<bl>
                            </div>
                        </div>
                        <div class="time">
                            <span>출근 <p>00:00</p></span>
                            <span>퇴근 <p>-</p></span>
                        </div>
                    </div>
                    <div class="mainState gtw">출근</div>
                </div>
                <div class="mainUserSec">
                    <div class="top">
                        <div class="user">
                            <div class="proImg"></div>
                            <div class="profile">
                                <span>
                                    황보현진
                                    <p>[직책명]</p>
                                </span>
                                <bl>abc1234567<bl>
                            </div>
                        </div>
                        <div class="time">
                            <span>출근 <p>00:00</p></span>
                            <span>퇴근 <p>00:00</p></span>
                        </div>
                    </div>
                    <div class="mainState lw">퇴근</div>
                </div>
                <div class="mainUserSec">
                    <div class="top">
                        <div class="user">
                            <div class="proImg"></div>
                            <div class="profile">
                                <span>
                                    황보현진
                                    <p>[직책명]</p>
                                </span>
                                <bl>abc1234567<bl>
                            </div>
                        </div>
                        <div class="time">
                            <span>출근 <p>-</p></span>
                            <span>퇴근 <p>-</p></span>
                        </div>
                    </div>
                    <div class="mainState vac">휴가</div>
                </div>
                <div class="mainUserSec">
                    <div class="top">
                        <div class="user">
                            <div class="proImg"></div>
                            <div class="profile">
                                <span>
                                    황보현진
                                    <p>[직책명]</p>
                                </span>
                                <bl>abc1234567<bl>
                            </div>
                        </div>
                        <div class="time">
                            <span>출근 <p>-</p></span>
                            <span>퇴근 <p>-</p></span>
                        </div>
                    </div>
                    <div class="mainState">미출근</div>
                </div>
                <div class="mainUserSec">
                    <div class="top">
                        <div class="user">
                            <div class="proImg"></div>
                            <div class="profile">
                                <span>
                                    황보현진
                                    <p>[직책명]</p>
                                </span>
                                <bl>abc1234567<bl>
                            </div>
                        </div>
                        <div class="time">
                            <span>출근 <p>-</p></span>
                            <span>퇴근 <p>-</p></span>
                        </div>
                    </div>
                    <div class="mainState">미출근</div>
                </div>
                <div class="mainUserSec">
                    <div class="top">
                        <div class="user">
                            <div class="proImg"></div>
                            <div class="profile">
                                <span>
                                    황보현진
                                    <p>[직책명]</p>
                                </span>
                                <bl>abc1234567<bl>
                            </div>
                        </div>
                        <div class="time">
                            <span>출근 <p>-</p></span>
                            <span>퇴근 <p>-</p></span>
                        </div>
                    </div>
                    <div class="mainState">미출근</div>
                </div>
            </div>
        </div>
    </div>
    <!-- 컨텐츠 영역 -->
     <!-- 하단 영역 -->
    <div class="submit submit-employee">
        <button class="start">업무시작</button>
    </div>
    <!-- 하단 영역 -->

    <script>
        $(function () {
            let today = new Date();
            let currentMonth = today.getMonth();
            let currentYear = today.getFullYear();
            let isCollapsed = true; // 접힘 상태 여부

            function updateCalendarView() {
                $("#calendar").datepicker("destroy").datepicker({
                    showOtherMonths: true,
                    selectOtherMonths: true,
                    firstDay: 1, // 월요일 시작
                    dayNamesMin: ["Sun", "Mon", "Tue", "Wed", "Thu", "Fri", "Sat"], // 요일 3글자로 표시
                    beforeShowDay: function (date) {
                        let todayString = $.datepicker.formatDate('yy-mm-dd', today);
                        let dateString = $.datepicker.formatDate('yy-mm-dd', date);
                        return [true, dateString === todayString ? "today-highlight" : ""];
                    },
                    onChangeMonthYear: function (year, month) {
                        currentYear = year;
                        currentMonth = month - 1;
                        updateHeader();
                    }
                });

                if (isCollapsed) {
                    showCurrentWeek();
                }
            }


            function updateHeader() {
                $("#current-month").text(`${currentYear}년 ${currentMonth + 1}월`);
            }

            function showCurrentWeek() {
                let startDate = new Date(today);
                startDate.setDate(today.getDate() - today.getDay() + 1); // 월요일로 이동
                $("#calendar .ui-datepicker-calendar tbody tr").each(function () {
                    let firstCell = $(this).find("td:first");
                    let cellDate = firstCell.text();
                    if (cellDate == startDate.getDate()) {
                        $(this).siblings().hide(); // 다른 주 숨기기
                    }
                });
            }

            let currentDate = new Date(); // 현재 날짜 저장

            function updateCalendar() {
                $("#calendar").datepicker("setDate", currentDate); // 실제 달력 업데이트
            }

            $("#prev-month").click(function () {
                currentDate.setMonth(currentDate.getMonth() - 1); // 이전 달로 변경
                updateHeader(); // 헤더 업데이트
                updateCalendar(); // 달력 UI 업데이트
            });

            $("#next-month").click(function () {
                currentDate.setMonth(currentDate.getMonth() + 1); // 다음 달로 변경
                updateHeader();
                updateCalendar();
            });

            function updateHeader() {
                let year = currentDate.getFullYear();
                let month = currentDate.getMonth() + 1;
                $("#current-month").text(`${year}년 ${month}월`);
            }


            $("#toggle-view").click(function () {
                isCollapsed = !isCollapsed;

                // 아이콘 변경
                let icon = $(this).find("i");
                if (isCollapsed) {
                    icon.removeClass("fa-angle-up").addClass("fa-angle-down"); // 접힘 상태
                } else {
                    icon.removeClass("fa-angle-down").addClass("fa-angle-up"); // 펼침 상태
                }

                updateCalendarView();
            });


            updateCalendarView();
            updateHeader();
        });
    </script>
</body>

</html>